var Osc,fs,saveRaw,saveWav,wavheader;Osc=require('./oscillator');fs=require('fs');saveRaw=function(e){var n,t,r,l,a,i,o,u,m,f,d,s,h,b,p,w,c,g,A,C,P,S,R,L,N,T;if(e==null){throw new Error('Option required (filename & obj with .tf())')}if(((w=e.signal)!=null?w.tf:void 0)==null){throw new Error('signal filed required (must have .tf())')}T=e.signal;if(e.fileName==null){throw new Error('fileName field required')}if(typeof e.fileName!=='string'){throw new Error('fileName must be a string')}i=e.fileName;e.sampleRate==null&&(e.sampleRate=44100);if(typeof e.sampleRate!=='number'){throw new Error('sampleRate must be numeric')}L=e.sampleRate;e.bitPerSample==null&&(e.bitPerSample=16);if(typeof e.bitPerSample!=='number'){throw new Error('bitPerSample must be numeric')}if((c=e.bitPerSample)!==8&&c!==16&&c!==24&&c!==32){throw new Error('bitPerSample supported: 8, 16, 24, 32')}n=e.bitPerSample;e.duration==null&&(e.duration=1);if(typeof e.duration!=='number'){throw new Error('duration must be numeric')}l=e.duration;e.endian==null&&(e.endian='LITTLE');if(typeof e.endian!=='string'){throw new Error("endian must be a string ('LITTLE' or 'BIG')")}if((g=e.endian)!=='LITTLE'&&g!=='BIG'){throw new Error("endian must be 'LITTLE' or 'BIG'")}a=e.endian;b=Math.floor(L*l);N=new Array(b);s=(Math.pow(2,n))/2-1;for(h=u=0, A=N.length;0<=A?u<A:u>A;h=0<=A?++u:--u)N[h]=Math.floor(T.tf(h/L)*s);t=Math.floor(n/8);r=new Uint8Array(N.length*t);if(a==='LITTLE'){for(h=m=0, C=N.length;0<=C?m<C:m>C;h=0<=C?++m:--m){for(o=f=0, P=t;0<=P?f<P:f>P;o=0<=P?++f:--f)r[h*t+o]=N[h]>>8*o&255}}else{for(h=d=0, S=N.length;0<=S?d<S:d>S;h=0<=S?++d:--d){for(o=p=0, R=t;0<=R?p<R:p>R;o=0<=R?++p:--p)r[h*t+o]=N[h]>>8*(t-1-o)&255}}return fs.writeFile(i,Buffer.from(r),function(e){if(e){throw e}})};saveWav=function(e){var n,t,r,l,a,i,o,u,m,f,d,s,h,b,p,w,c,g,A,C,P,S,R,L,N,T;if(e==null){throw new Error('Option required (filename & obj with .tf())')}if(((c=e.signal)!=null?c.tf:void 0)==null){throw new Error('signal filed required (must have .tf())')}T=e.signal;if(e.fileName==null){throw new Error('fileName field required')}if(typeof e.fileName!=='string'){throw new Error('fileName must be a string')}i=e.fileName;e.sampleRate==null&&(e.sampleRate=44100);if(typeof e.sampleRate!=='number'){throw new Error('sampleRate must be numeric')}L=e.sampleRate;e.bitPerSample==null&&(e.bitPerSample=16);if(typeof e.bitPerSample!=='number'){throw new Error('bitPerSample must be numeric')}if((g=e.bitPerSample)!==8&&g!==16&&g!==24&&g!==32){throw new Error('bitPerSample supported: 8, 16, 24, 32')}n=e.bitPerSample;e.duration==null&&(e.duration=1);if(typeof e.duration!=='number'){throw new Error('duration must be numeric')}a=e.duration;p=Math.floor(L*a);N=new Array(p);h=Math.pow(2,n)/2-1;for(b=m=0, A=N.length;0<=A?m<A:m>A;b=0<=A?++m:--m)N[b]=Math.floor(T.tf(b/L)*h);t=Math.floor(n/8);r=new Uint8Array(N.length*t);for(b=f=0, C=N.length;0<=C?f<C:f>C;b=0<=C?++f:--f){for(u=d=0, P=t;0<=P?d<P:d>P;u=0<=P?++d:--d)r[b*t+u]=N[b]>>8*u&255}o=wavheader(N,n,L);l=new Uint8Array(o.length+r.length);for(u=s=0, S=o.length;0<=S?s<S:s>S;u=0<=S?++s:--s)l[u]=o[u];for(u=w=0, R=r.length;0<=R?w<R:w>R;u=0<=R?++w:--w)l[u+o.length]=r[u];return fs.writeFile(i,Buffer.from(l),function(e){if(e){throw e}})};wavheader=function(e,n,t){var r,l,a,i,o,u;u=new Uint8Array(44);u[0]=82;u[1]=73;u[2]=70;u[3]=70;a=Math.floor(n/8);r=e.length*a*1;o=r+36;u[4]=o&255;u[5]=o>>8&255;u[6]=o>>16&255;u[7]=o>>24&255;u[8]=87;u[9]=65;u[10]=86;u[11]=69;u[12]=102;u[13]=109;u[14]=116;u[15]=32;u[16]=16;u[17]=0;u[18]=0;u[19]=0;u[20]=1;u[21]=0;u[22]=1;u[23]=0;u[24]=t&255;u[25]=t>>8&255;u[26]=t>>16&255;u[27]=t>>24&255;i=t*n*1/8;u[28]=i&255;u[29]=i>>8&255;u[30]=i>>16&255;u[31]=i>>24&255;l=n/8*1;u[32]=l&255;u[33]=l>>8&255;u[34]=n&255;u[35]=n>>8&255;u[36]=100;u[37]=97;u[38]=116;u[39]=97;u[40]=r&255;u[41]=r>>8&255;u[42]=r>>16&255;u[43]=r>>24&255;return u};exports.saveRaw=saveRaw;exports.saveWav=saveWav